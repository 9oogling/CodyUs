<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" type="text/css" href="/css/header.css">
    <link rel="stylesheet" type="text/css" href="/css/footer.css">
</head>
<body>
<div th:insert="header :: header-content"></div>

<div class="search-results" id="search-results">
    <!-- 검색 결과가 여기에 표시됩니다. -->
</div>

<div class="pagination" id="pagination">
    <!-- 페이지네이션 링크가 여기에 표시됩니다. -->
</div>


<div th:insert="footer :: footer-content"></div>

<script>
    function searchPosts(page = 1) {
        const keyword = $('#search-keyword').val();
        const type = $('#search-type').val();
        const size = 10;  // 페이지당 게시물 수
        const sortBy = 'id';
        const descending = false;

        $.ajax({
            url: '/api/posts/search',
            type: 'GET',
            data: {
                keyword: keyword,
                type: type,
                page: page,
                size: size,
                sortBy: sortBy,
                descending: descending
            },
            success: function(response) {
                const posts = response.data.content;
                const totalPages = response.data.totalPages;
                const resultsContainer = $('#search-results');
                const paginationContainer = $('#pagination');

                // 검색 결과를 초기화합니다.
                resultsContainer.empty();

                // 검색 결과를 표시합니다.
                posts.forEach(post => {
                    const postHtml = `
                    <div class="post-item">
                        <div class="post-header">
                            <img src="https://via.placeholder.com/32" alt="User avatar" class="post-avatar">
                            <span class="post-username">${post.username}</span>
                        </div>
                        <img src="${post.imageUrl}" alt="Post image" class="post-image">
                        <div class="post-likes">${post.likes} likes</div>
                        <div class="post-caption"><strong>${post.username}</strong> ${post.caption}</div>
                    </div>
                `;
                    resultsContainer.append(postHtml);
                });

                // 페이지네이션을 초기화합니다.
                paginationContainer.empty();

                // 페이지네이션 링크를 생성합니다.
                for (let i = 1; i <= totalPages; i++) {
                    const pageLink = `<span class="page-link" onclick="searchPosts(${i})">${i}</span>`;
                    paginationContainer.append(pageLink);
                }
            },
            error: function(error) {
                console.error('Error fetching search results:', error);
            }
        });
    }
</script>
</body>
</html>